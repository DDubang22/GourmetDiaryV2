{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport Modal from \"./RegisterFormModal.vue\";\nimport axios from 'axios';\nexport default {\n  name: \"kakaoMap\",\n  data() {\n    return {\n      map: null,\n      open_modal: false,\n      shop: '미세노센세',\n      overlay: null,\n      marker: null,\n      markerInfos: []\n    };\n  },\n  beforeUpdate() {\n    const prevMarkerInfosLength = this.$data._prevMarkerInfosLength || 0;\n\n    // markerInfos 배열의 길이가 변경되었을 때만 맵을 리로드\n    if (this.markerInfos.length !== prevMarkerInfosLength) {\n      this.$data._prevMarkerInfosLength = this.markerInfos.length;\n      this.loadMap();\n    }\n  },\n  mounted() {\n    if (window.kakao && window.kakao.maps) {\n      this.loadMap();\n    } else {\n      const script = document.createElement(\"script\");\n      script.onload = () => {\n        window.kakao.maps.load(this.loadMap);\n      };\n      script.src = \"//dapi.kakao.com/v2/maps/sdk.js?autoload=false&appkey=915cffed372954b7b44804ed422b9cf0\";\n      document.head.appendChild(script);\n    }\n  },\n  methods: {\n    loadMap() {\n      this.fetchData();\n      const container = document.getElementById(\"map\");\n      const options = {\n        center: new window.kakao.maps.LatLng(36.34610445888127, 127.38851977413381),\n        level: 3\n      };\n      this.map = new window.kakao.maps.Map(container, options);\n      this.addMarker();\n    },\n    addMarker() {\n      this.markerInfos.push({\n        position: new window.kakao.maps.LatLng(36.346040, 127.388857),\n        shop: {\n          name: '미세노 센세',\n          address: '대전 서구 계룡로553번안길 65 웨스턴빌딩 1층',\n          postalCode: '35263',\n          jibun: '탄방동 757',\n          website: 'http://map.naver.com/p/entry/place/13472781?lng=127.388844605869&lat=36.346045287555995&placePath=%2Fhome&entry=plt',\n          image: 'https://search.pstatic.net/common/?src=https%3A%2F%2Fldb-phinf.pstatic.net%2F20200103_48%2F1578045531270sJ3xQ_JPEG%2F07tuzBm7aoaPnzE4BoiEG5e_.jpeg.jpg'\n        }\n      });\n      this.markerInfos.push({\n        position: new window.kakao.maps.LatLng(36.344040, 127.385857),\n        shop: {\n          name: '김포시가 한국 사회에 울린 마지막',\n          address: '한겨레21',\n          postalCode: '12345',\n          jibun: '김포시',\n          website: 'https://n.news.naver.com/article/036/0000049006?cds=news_media_pc&type=editn',\n          image: 'https://imgnews.pstatic.net/image/036/2023/11/16/0000049006_001_20231116173501093.jpg?type=w647'\n        }\n      });\n      console.log(this.markerInfos);\n      this.markerInfos.forEach(markerInfo => {\n        const marker = new window.kakao.maps.Marker({\n          map: this.map,\n          position: markerInfo.position\n        });\n        const content = `\n            <div class=\"wrap\">\n                <div class=\"info\">\n                    <div class=\"title\">\n                        ${markerInfo.shop.name}\n                        <div class=\"close\" title=\"닫기\"></div>\n                    </div>\n                    <div class=\"body\">\n                        <div class=\"img\">\n                            <img src=\"${markerInfo.shop.image}\" width=\"73\" height=\"70\">\n                        </div>\n                        <div class=\"desc\">\n                            <div class=\"ellipsis\">${markerInfo.shop.address}</div>\n                            <div class=\"jibun ellipsis\">${markerInfo.shop.postalCode} (지번) ${markerInfo.shop.jibun}</div>\n                            <div><a href=\"${markerInfo.shop.website}\" target=\"_blank\" class=\"link\">홈페이지</a></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `;\n        const overlay = new window.kakao.maps.CustomOverlay({\n          content: content,\n          map: this.map,\n          position: marker.getPosition()\n        });\n        window.kakao.maps.event.addListener(marker, 'click', () => {\n          if (overlay.getMap()) {\n            overlay.setMap(null);\n          } else {\n            overlay.setMap(this.map);\n          }\n        });\n      });\n    },\n    async fetchData() {\n      try {\n        const response = await axios.get('/map');\n        const markerInfosFromServer = response.data; // Assuming the response is an array of items\n        console.log(markerInfosFromServer);\n        const markerInfosArray = Array.isArray(markerInfosFromServer) ? markerInfosFromServer : [markerInfosFromServer];\n        markerInfosArray.forEach(markerInfo => {\n          // markerInfo를 사용하여 원하는 작업 수행\n          const newMarkerInfo = {\n            position: new window.kakao.maps.LatLng(markerInfo.latitude, markerInfo.longitude),\n            shop: {\n              name: markerInfo.shopName,\n              address: markerInfo.shopAddress,\n              postalCode: markerInfo.shopPostalCode,\n              jibun: markerInfo.shopJibun,\n              website: markerInfo.shopWebsiteAddress,\n              image: markerInfo.shopImageAddress\n            }\n          };\n\n          // this.markerInfos 배열에 새로운 데이터 추가\n          this.markerInfos.push(newMarkerInfo);\n        });\n        console.log(this.markerInfos);\n      } catch (error) {\n        console.error('Error fetching data', error);\n      }\n    }\n  },\n  components: {\n    Modal\n  }\n};","map":{"version":3,"names":["Modal","axios","name","data","map","open_modal","shop","overlay","marker","markerInfos","beforeUpdate","prevMarkerInfosLength","$data","_prevMarkerInfosLength","length","loadMap","mounted","window","kakao","maps","script","document","createElement","onload","load","src","head","appendChild","methods","fetchData","container","getElementById","options","center","LatLng","level","Map","addMarker","push","position","address","postalCode","jibun","website","image","console","log","forEach","markerInfo","Marker","content","CustomOverlay","getPosition","event","addListener","getMap","setMap","response","get","markerInfosFromServer","markerInfosArray","Array","isArray","newMarkerInfo","latitude","longitude","shopName","shopAddress","shopPostalCode","shopJibun","shopWebsiteAddress","shopImageAddress","error","components"],"sources":["/Users/jangsubhin/캡스톤디자인/gourmetdiary/vue/gourmetdiary/src/components/MapPage.vue"],"sourcesContent":["<template>\n   <div class=\"main\">\n        <div class=\"main_page\">\n            <div id=\"map\"></div>\n            <div class=\"form\">\n                <button type=\"button\" @click=\"open_modal = true\" >맛집 집어넣기</button>\n            </div>\n\n            <Modal  :open_modal=\"open_modal\" @closeModal=\"open_modal = false\" />\n\n        </div>\n    </div>\n</template>\n<script> \nimport Modal from \"./RegisterFormModal.vue\"\nimport axios from 'axios';\n\nexport default {\n    name: \"kakaoMap\",\n    data () {\n        return {\n            map : null,\n            open_modal : false,\n            shop : '미세노센세',\n            overlay : null,\n            marker : null,\n\n            markerInfos : [],\n        };\n    },\n    beforeUpdate() {\n    const prevMarkerInfosLength = this.$data._prevMarkerInfosLength || 0;\n\n    // markerInfos 배열의 길이가 변경되었을 때만 맵을 리로드\n    if (this.markerInfos.length !== prevMarkerInfosLength) {\n      this.$data._prevMarkerInfosLength = this.markerInfos.length;\n      this.loadMap();\n    }\n  },\n    mounted() {\n      \n      if(window.kakao && window.kakao.maps) {\n        this.loadMap();\n      } else {\n        const script = document.createElement(\"script\");\n        script.onload = () => {\n            window.kakao.maps.load(this.loadMap);\n        };\n        \n        script.src=\n            \"//dapi.kakao.com/v2/maps/sdk.js?autoload=false&appkey=915cffed372954b7b44804ed422b9cf0\";\n        document.head.appendChild(script);    \n      }\n      \n    },\n    methods: {\n         loadMap () {\n             this.fetchData();\n            const container = document.getElementById(\"map\");\n            const options = {\n                center: new window.kakao.maps.LatLng(36.34610445888127, 127.38851977413381),\n                level : 3,\n            };\n            this.map = new window.kakao.maps.Map(container,options);\n            this.addMarker();\n        },\n        addMarker() {\n        this.markerInfos.push(\n        {\n            position: new window.kakao.maps.LatLng(36.346040, 127.388857),\n            shop: {\n                name: '미세노 센세',\n                address: '대전 서구 계룡로553번안길 65 웨스턴빌딩 1층',\n                postalCode: '35263',\n                jibun: '탄방동 757',\n                website: 'http://map.naver.com/p/entry/place/13472781?lng=127.388844605869&lat=36.346045287555995&placePath=%2Fhome&entry=plt',\n                image: 'https://search.pstatic.net/common/?src=https%3A%2F%2Fldb-phinf.pstatic.net%2F20200103_48%2F1578045531270sJ3xQ_JPEG%2F07tuzBm7aoaPnzE4BoiEG5e_.jpeg.jpg'\n            }\n        });\n\n        this.markerInfos.push(\n        {\n            position: new window.kakao.maps.LatLng(36.344040, 127.385857),\n            shop: {\n                name: '김포시가 한국 사회에 울린 마지막',\n                address: '한겨레21',\n                postalCode: '12345',\n                jibun: '김포시',\n                website: 'https://n.news.naver.com/article/036/0000049006?cds=news_media_pc&type=editn',\n                image: 'https://imgnews.pstatic.net/image/036/2023/11/16/0000049006_001_20231116173501093.jpg?type=w647'\n            }\n        });\n       \n    \n        console.log(this.markerInfos);\n    this.markerInfos.forEach(markerInfo => {\n        const marker = new window.kakao.maps.Marker({\n            map: this.map,\n            position: markerInfo.position,\n        });\n\n        const content = `\n            <div class=\"wrap\">\n                <div class=\"info\">\n                    <div class=\"title\">\n                        ${markerInfo.shop.name}\n                        <div class=\"close\" title=\"닫기\"></div>\n                    </div>\n                    <div class=\"body\">\n                        <div class=\"img\">\n                            <img src=\"${markerInfo.shop.image}\" width=\"73\" height=\"70\">\n                        </div>\n                        <div class=\"desc\">\n                            <div class=\"ellipsis\">${markerInfo.shop.address}</div>\n                            <div class=\"jibun ellipsis\">${markerInfo.shop.postalCode} (지번) ${markerInfo.shop.jibun}</div>\n                            <div><a href=\"${markerInfo.shop.website}\" target=\"_blank\" class=\"link\">홈페이지</a></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `;\n\n        const overlay = new window.kakao.maps.CustomOverlay({\n            content: content,\n            map: this.map,\n            position: marker.getPosition(),\n        });\n\n        window.kakao.maps.event.addListener(marker, 'click', () => {\n            if (overlay.getMap()) {\n                overlay.setMap(null);\n            } else {\n                overlay.setMap(this.map);\n            }\n        });\n    });\n},\n        async fetchData() {\n            try {\n            const response = await axios.get('/map');\n            const markerInfosFromServer = response.data; // Assuming the response is an array of items\n            console.log(markerInfosFromServer);\n\n            const markerInfosArray = Array.isArray(markerInfosFromServer) ? markerInfosFromServer : [markerInfosFromServer];\n\n            \n            markerInfosArray.forEach(markerInfo => {\n            // markerInfo를 사용하여 원하는 작업 수행\n            const newMarkerInfo = {\n                position: new window.kakao.maps.LatLng(markerInfo.latitude, markerInfo.longitude),\n                shop: {\n                    name: markerInfo.shopName,\n                    address: markerInfo.shopAddress,\n                    postalCode: markerInfo.shopPostalCode,\n                    jibun: markerInfo.shopJibun,\n                    website: markerInfo.shopWebsiteAddress,\n                    image: markerInfo.shopImageAddress\n                }\n            };\n\n            // this.markerInfos 배열에 새로운 데이터 추가\n            this.markerInfos.push(newMarkerInfo);\n        });\n\n      \n\n            console.log(this.markerInfos);\n\n        } catch (error) {\n            console.error('Error fetching data', error);\n        }\n    },\n\n\n    },\n    components : {\n        Modal,\n    }\n}\n</script>\n\n<style>\nbody {\n    margin : 0;\n    padding : 0;\n}\n.main {\n    position: absolute;\n    bottom: 0;\n    right : 0;\n\n}\n.main_page {\n    width:85vw;\n    height: 100vh;\n}\n\n#map {\n    width: 100%;\n    height:100vh;\n}\n\n.form {\n    width: 300px;\n    height: 50px;\n    \n    position: absolute;\n    z-index: 3;\n    top: 0;\n    right: 0;\n}\n\n.wrap {position: absolute;left: 0;bottom: 40px;width: 288px;height: 132px;margin-left: -144px;text-align: left;overflow: hidden;font-size: 12px;font-family: 'Malgun Gothic', dotum, '돋움', sans-serif;line-height: 1.5;}\n    .wrap * {padding: 0;margin: 0;}\n    .wrap .info {width: 286px;height: 120px;border-radius: 5px;border-bottom: 2px solid #ccc;border-right: 1px solid #ccc;overflow: hidden;background: #fff;}\n    .wrap .info:nth-child(1) {border: 0;box-shadow: 0px 1px 2px #888;}\n    .info .title {padding: 5px 0 0 10px;height: 30px;background: #eee;border-bottom: 1px solid #ddd;font-size: 18px;font-weight: bold;}\n    .info .close {position: absolute;top: 10px;right: 10px;color: #888;width: 17px;height: 17px;background: url('https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/overlay_close.png');}\n    .info .close:hover {cursor: pointer;}\n    .info .body {position: relative;overflow: hidden;}\n    .info .desc {position: relative;margin: 13px 0 0 90px;height: 75px;}\n    .desc .ellipsis {overflow: hidden;text-overflow: ellipsis;white-space: nowrap;}\n    .desc .jibun {font-size: 11px;color: #888;margin-top: -2px;}\n    .info .img {position: absolute;top: 6px;left: 5px;width: 73px;height: 71px;border: 1px solid #ddd;color: #888;overflow: hidden;}\n    .info:after {content: '';position: absolute;margin-left: -12px;left: 50%;bottom: 0;width: 22px;height: 12px;background: url('https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/vertex_white.png')}\n    .info .link {color: #5085BB;}\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}